[{"path":"https://mictott.github.io/SpotSweeper/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to SpotSweeper","title":"Contributing to SpotSweeper","text":"outlines propose change SpotSweeper. detailed discussion contributing tidyverse packages, please see development contributing guide code review principles.","code":""},{"path":"https://mictott.github.io/SpotSweeper/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to SpotSweeper","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://mictott.github.io/SpotSweeper/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to SpotSweeper","text":"want make bigger change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See guide create great issue advice.","code":""},{"path":"https://mictott.github.io/SpotSweeper/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to SpotSweeper","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"MicTott/SpotSweeper\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"https://mictott.github.io/SpotSweeper/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to SpotSweeper","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://mictott.github.io/SpotSweeper/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to SpotSweeper","text":"Please note SpotSweeper project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://mictott.github.io/SpotSweeper/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 SpotSweeper authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mictott.github.io/SpotSweeper/SUPPORT.html","id":null,"dir":"","previous_headings":"","what":"Getting help with SpotSweeper","title":"Getting help with SpotSweeper","text":"Thank using SpotSweeper! filing issue, things know make process smooth possible parties.","code":""},{"path":"https://mictott.github.io/SpotSweeper/SUPPORT.html","id":"make-a-reprex","dir":"","previous_headings":"","what":"Make a reprex","title":"Getting help with SpotSweeper","text":"Start making minimally reproducible example, also known ‘reprex’. may use reprex R package create one, though necessary help. make R-question-asking endeavors easier. Learning use takes 5 10 minutes. tips make minimally reproducible example, see StackOverflow link.","code":""},{"path":"https://mictott.github.io/SpotSweeper/SUPPORT.html","id":"where-to-post-it","dir":"","previous_headings":"","what":"Where to post it?","title":"Getting help with SpotSweeper","text":"Bioconductor help web page gives overview places may help answer question. Bioconductor software related questions, bug reports feature requests, addressed appropriate Bioconductor/SpotSweeper GitHub repository. Follow bug report feature request templates GitHub. package GitHub repository, see next bullet point. Bioconductor software usage questions addressed Bioconductor Support Website. Make sure use appropriate package tag, otherwise package authors get notification. General R questions can posed StackOverflow RStudio Community website especially pertain tidyverse RStudio GUI related products.","code":""},{"path":"https://mictott.github.io/SpotSweeper/SUPPORT.html","id":"issues-or-feature-requests","dir":"","previous_headings":"","what":"Issues or Feature Requests","title":"Getting help with SpotSweeper","text":"opening new issue feature request, sure search issues pull requests ensure one already exist implemented development version. Note. can remove :open search term issues page search open closed issues. See link learn modifying search.","code":""},{"path":"https://mictott.github.io/SpotSweeper/SUPPORT.html","id":"what-happens-next","dir":"","previous_headings":"","what":"What happens next?","title":"Getting help with SpotSweeper","text":"Bioconductor maintainers limited resources strive responsive possible. Please forget tag appropriate maintainer issue GitHub username (e.g., @username). order make easy possible Bioconductor core developers remediate issue. Provide accurate, brief, reproducible report outlined issue templates. Thank trusting Bioconductor.","code":""},{"path":"https://mictott.github.io/SpotSweeper/articles/getting_started.html","id":"input-data-format","dir":"Articles","previous_headings":"","what":"Input data format","title":"Getting started with 'SpotSweeper'","text":"examples , assume input data provided SpatialExperiment (SPE) object. outputs spot-level outliers artifacts stored colData SPE object.","code":""},{"path":"https://mictott.github.io/SpotSweeper/articles/getting_started.html","id":"spot-level-local-outlier-detection","dir":"Articles","previous_headings":"","what":"Spot-level local outlier detection","title":"Getting started with 'SpotSweeper'","text":"example workflow showing detect visualize local outliers 10X Genomics Visium data. SpotSweeper can run SPE object following code. outputs local_outliers colData SPE object. Selecting data_output=TRUE exports z-transformed QC metrics well. can now visualize local_outliers vs one QC metrics, sum_log2, help escheR package.","code":"library(SpotSweeper)   # load  Maynard et al DLPFC daatset spe <- STexampleData::Visium_humanDLPFC()  # change from gene id to gene names rownames(spe) <- rowData(spe)$gene_name  # show column data before SpotSweeper colnames(colData(spe)) #> [1] \"barcode_id\"   \"sample_id\"    \"in_tissue\"    \"array_row\"    \"array_col\"    #> [6] \"ground_truth\" \"cell_count\"  # drop out-of-tissue spots spe <- spe[, spe$in_tissue == 1] spe <- spe[, !is.na(spe$ground_truth)] # Identifying the mitochondrial transcripts in our SpatialExperiment. is.mito <- rownames(spe)[grepl(\"^MT-\", rownames(spe))]  # Calculating QC metrics for each spot using scuttle spe<- scuttle::addPerCellQCMetrics(spe, subsets=list(Mito=is.mito)) colnames(colData(spe)) #>  [1] \"barcode_id\"            \"sample_id\"             \"in_tissue\"             #>  [4] \"array_row\"             \"array_col\"             \"ground_truth\"          #>  [7] \"cell_count\"            \"sum\"                   \"detected\"              #> [10] \"subsets_Mito_sum\"      \"subsets_Mito_detected\" \"subsets_Mito_percent\"  #> [13] \"total\"  # Identifying local outliers using SpotSweeper features <- c('sum' ,'detected', \"subsets_Mito_percent\") spe<- localOutliers(spe,                      features=features,                     n_neighbors=18,                      data_output=TRUE,                     method=\"multivariate\"                     )  # show column data after SpotSweeper colnames(colData(spe)) #>  [1] \"barcode_id\"                \"sample_id\"                 #>  [3] \"in_tissue\"                 \"array_row\"                 #>  [5] \"array_col\"                 \"ground_truth\"              #>  [7] \"cell_count\"                \"sum\"                       #>  [9] \"detected\"                  \"subsets_Mito_sum\"          #> [11] \"subsets_Mito_detected\"     \"subsets_Mito_percent\"      #> [13] \"total\"                     \"sum_log2\"                  #> [15] \"detected_log2\"             \"subsets_Mito_percent_log2\" #> [17] \"coords\"                    \"local_outliers\"            #> [19] \"sum_z\"                     \"detected_z\"                #> [21] \"subsets_Mito_percent_z\"    \"LOF\" library(escheR) library(ggpubr)  # plotting using escheR p1 <- make_escheR(spe) |>    add_fill(var = \"sum_log2\", point_size=1.25) +   scale_fill_gradient(low =\"white\",high =  \"darkgreen\")  p2 <- make_escheR(spe) |>    add_fill(var = \"sum_log2\", point_size=1.25) |>   add_ground(var = \"local_outliers\", stroke = 1) +   scale_color_manual(     name = \"\", # turn off legend name for ground_truth     values = c(       \"TRUE\" = \"red\",       \"FALSE\" = \"transparent\")   ) +   scale_fill_gradient(low =\"white\",high =  \"darkgreen\")  plot_list <- list(p1, p2) ggarrange(   plotlist = plot_list,   ncol = 2, nrow = 1,   common.legend = FALSE )"},{"path":"https://mictott.github.io/SpotSweeper/articles/getting_started.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Getting started with 'SpotSweeper'","text":"","code":"utils::sessionInfo() #> R version 4.3.2 (2023-10-31) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] ggpubr_0.6.0                escheR_1.2.0                #>  [3] ggplot2_3.4.4               STexampleData_1.10.0        #>  [5] SpatialExperiment_1.12.0    SingleCellExperiment_1.24.0 #>  [7] SummarizedExperiment_1.32.0 Biobase_2.62.0              #>  [9] GenomicRanges_1.54.1        GenomeInfoDb_1.38.6         #> [11] IRanges_2.36.0              S4Vectors_0.40.2            #> [13] MatrixGenerics_1.14.0       matrixStats_1.2.0           #> [15] ExperimentHub_2.10.0        AnnotationHub_3.10.0        #> [17] BiocFileCache_2.10.1        dbplyr_2.4.0                #> [19] BiocGenerics_0.48.1         SpotSweeper_0.99.1          #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.1                     bitops_1.0-7                  #>   [3] rlang_1.1.3                   magrittr_2.0.3                #>   [5] compiler_4.3.2                RSQLite_2.3.5                 #>   [7] DelayedMatrixStats_1.24.0     png_0.1-8                     #>   [9] systemfonts_1.0.5             vctrs_0.6.5                   #>  [11] stringr_1.5.1                 pkgconfig_2.0.3               #>  [13] crayon_1.5.2                  fastmap_1.1.1                 #>  [15] backports_1.4.1               magick_2.8.2                  #>  [17] XVector_0.42.0                ellipsis_0.3.2                #>  [19] labeling_0.4.3                scuttle_1.12.0                #>  [21] utf8_1.2.4                    promises_1.2.1                #>  [23] rmarkdown_2.25                ragg_1.2.7                    #>  [25] purrr_1.0.2                   bit_4.0.5                     #>  [27] xfun_0.42                     beachmat_2.18.0               #>  [29] zlibbioc_1.48.0               cachem_1.0.8                  #>  [31] jsonlite_1.8.8                blob_1.2.4                    #>  [33] highr_0.10                    later_1.3.2                   #>  [35] DelayedArray_0.28.0           BiocParallel_1.36.0           #>  [37] interactiveDisplayBase_1.40.0 broom_1.0.5                   #>  [39] parallel_4.3.2                R6_2.5.1                      #>  [41] bslib_0.6.1                   stringi_1.8.3                 #>  [43] car_3.1-2                     jquerylib_0.1.4               #>  [45] Rcpp_1.0.12                   knitr_1.45                    #>  [47] httpuv_1.6.14                 Matrix_1.6-1.1                #>  [49] tidyselect_1.2.0              abind_1.4-5                   #>  [51] yaml_2.3.8                    codetools_0.2-19              #>  [53] curl_5.2.0                    lattice_0.21-9                #>  [55] tibble_3.2.1                  shiny_1.8.0                   #>  [57] withr_3.0.0                   KEGGREST_1.42.0               #>  [59] evaluate_0.23                 desc_1.4.3                    #>  [61] Biostrings_2.70.2             pillar_1.9.0                  #>  [63] BiocManager_1.30.22           filelock_1.0.3                #>  [65] carData_3.0-5                 generics_0.1.3                #>  [67] dbscan_1.1-12                 RCurl_1.98-1.14               #>  [69] BiocVersion_3.18.1            munsell_0.5.0                 #>  [71] scales_1.3.0                  sparseMatrixStats_1.14.0      #>  [73] xtable_1.8-4                  glue_1.7.0                    #>  [75] tools_4.3.2                   BiocNeighbors_1.20.2          #>  [77] ggsignif_0.6.4                fs_1.6.3                      #>  [79] cowplot_1.1.3                 grid_4.3.2                    #>  [81] tidyr_1.3.1                   colorspace_2.1-0              #>  [83] AnnotationDbi_1.64.1          GenomeInfoDbData_1.2.11       #>  [85] cli_3.6.2                     rappdirs_0.3.3                #>  [87] textshaping_0.3.7             fansi_1.0.6                   #>  [89] viridisLite_0.4.2             S4Arrays_1.2.0                #>  [91] dplyr_1.1.4                   gtable_0.3.4                  #>  [93] rstatix_0.7.2                 sass_0.4.8                    #>  [95] digest_0.6.34                 SparseArray_1.2.4             #>  [97] farver_2.1.1                  rjson_0.2.21                  #>  [99] memoise_2.0.1                 htmltools_0.5.7               #> [101] pkgdown_2.0.7                 lifecycle_1.0.4               #> [103] httr_1.4.7                    mime_0.12                     #> [105] bit64_4.0.5                   MASS_7.3-60"},{"path":"https://mictott.github.io/SpotSweeper/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Totty. Author, maintainer.","code":""},{"path":"https://mictott.github.io/SpotSweeper/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"MicTott (2024). SpotSweeper: Spot artifact-level quality control spatially-resolved transcriptomics data. doi:10.18129/B9.bioc.SpotSweeper, https://github.com/MicTott/SpotSweeper/SpotSweeper - R package version 0.99.1, http://www.bioconductor.org/packages/SpotSweeper. MicTott (2024). “SpotSweeper: Spot artifact-level quality control spatially-resolved transcriptomics data.” bioRxiv. doi:10.1101/TODO, https://www.biorxiv.org/content/10.1101/TODO.","code":"@Manual{,   title = {SpotSweeper: Spot and artifact-level quality control for spatially-resolved transcriptomics data},   author = {{MicTott}},   year = {2024},   url = {http://www.bioconductor.org/packages/SpotSweeper},   note = {https://github.com/MicTott/SpotSweeper/SpotSweeper - R package version 0.99.1},   doi = {10.18129/B9.bioc.SpotSweeper}, } @Article{,   title = {SpotSweeper: Spot and artifact-level quality control for spatially-resolved transcriptomics data},   author = {{MicTott}},   year = {2024},   journal = {bioRxiv},   doi = {10.1101/TODO},   url = {https://www.biorxiv.org/content/10.1101/TODO}, }"},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"spotsweeper","dir":"","previous_headings":"","what":"SpotSweeper","title":"SpotSweeper","text":"SpotSweeper package developed spatially-aware quality control (QC) methods detection, visualization, removal local outliers large artifacts spot-based spatial transcriptomics data, 10x Genomics Visium, using standard QC metrics.","code":""},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"installation-instructions","dir":"","previous_headings":"","what":"Installation instructions","title":"SpotSweeper","text":"Currently, way install SpotSweeper downloading development version can installed GitHub using following: accepted Bioconductor, SpotSweeper installable using:","code":"if (!require(\"devtools\")) install.packages(\"devtools\") remotes::install_github(\"MicTott/SpotSweeper\") } if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") }  BiocManager::install(\"SpotSweeper\")"},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"tutorial-in-progress","dir":"","previous_headings":"","what":"Tutorial (in progress)","title":"SpotSweeper","text":"detailed tutorial available package vignette Bioconductor. direct link tutorial / package vignette available .","code":""},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"input-data-format","dir":"","previous_headings":"","what":"Input data format","title":"SpotSweeper","text":"examples , assume input data provided SpatialExperiment (SPE) object. outputs spot-level outliers artifacts stored colData SPE object.","code":""},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"spot-level-local-outlier-detection","dir":"","previous_headings":"","what":"Spot-level local outlier detection","title":"SpotSweeper","text":"example workflow showing detect visualize local outliers 10X Genomics Visium data. SpotSweeper can run SPE object following code. outputs local_outliers colData SPE object. Selecting data_output=TRUE exports z-transformed QC metrics well. can now visualize local_outliers vs one QC metrics, sum_log2, help escheR package.","code":"library(SpotSweeper)   # load  Maynard et al DLPFC daatset spe <- STexampleData::Visium_humanDLPFC() #> Warning: package 'S4Vectors' was built under R version 4.3.2 #> Warning: package 'GenomeInfoDb' was built under R version 4.3.2 #> see ?STexampleData and browseVignettes('STexampleData') for documentation #> loading from cache  # change from gene id to gene names rownames(spe) <- rowData(spe)$gene_name  # show column data before SpotSweeper colnames(colData(spe)) #> [1] \"barcode_id\"   \"sample_id\"    \"in_tissue\"    \"array_row\"    \"array_col\"    #> [6] \"ground_truth\" \"cell_count\"  # drop out-of-tissue spots spe <- spe[, spe$in_tissue == 1] spe <- spe[, !is.na(spe$ground_truth)] # Identifying the mitochondrial transcripts in our SpatialExperiment. is.mito <- rownames(spe)[grepl(\"^MT-\", rownames(spe))]  # Calculating QC metrics for each spot using scuttle spe<- scuttle::addPerCellQCMetrics(spe, subsets=list(Mito=is.mito)) colnames(colData(spe)) #>  [1] \"barcode_id\"            \"sample_id\"             \"in_tissue\"             #>  [4] \"array_row\"             \"array_col\"             \"ground_truth\"          #>  [7] \"cell_count\"            \"sum\"                   \"detected\"              #> [10] \"subsets_Mito_sum\"      \"subsets_Mito_detected\" \"subsets_Mito_percent\"  #> [13] \"total\"  # Identifying local outliers using SpotSweeper features <- c('sum' ,'detected', \"subsets_Mito_percent\") spe<- localOutliers(spe,                      features=features,                     n_neighbors=18,                      data_output=TRUE,                     method=\"multivariate\"                     )  # show column data after SpotSweeper colnames(colData(spe)) #>  [1] \"barcode_id\"                \"sample_id\"                 #>  [3] \"in_tissue\"                 \"array_row\"                 #>  [5] \"array_col\"                 \"ground_truth\"              #>  [7] \"cell_count\"                \"sum\"                       #>  [9] \"detected\"                  \"subsets_Mito_sum\"          #> [11] \"subsets_Mito_detected\"     \"subsets_Mito_percent\"      #> [13] \"total\"                     \"sum_log2\"                  #> [15] \"detected_log2\"             \"subsets_Mito_percent_log2\" #> [17] \"coords\"                    \"local_outliers\"            #> [19] \"sum_z\"                     \"detected_z\"                #> [21] \"subsets_Mito_percent_z\"    \"LOF\" library(escheR) #> Loading required package: ggplot2 library(ggpubr)  # plotting using escheR p1 <- make_escheR(spe) |>    add_fill(var = \"sum_log2\", point_size=1.25) +   scale_fill_gradient(low =\"white\",high =  \"darkgreen\") #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale.  p2 <- make_escheR(spe) |>    add_fill(var = \"sum_log2\", point_size=1.25) |>   add_ground(var = \"local_outliers\", stroke = 1) +   scale_color_manual(     name = \"\", # turn off legend name for ground_truth     values = c(       \"TRUE\" = \"red\",       \"FALSE\" = \"transparent\")   ) +   scale_fill_gradient(low =\"white\",high =  \"darkgreen\") #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale.  plot_list <- list(p1, p2) ggarrange(   plotlist = plot_list,   ncol = 2, nrow = 1,   common.legend = FALSE )"},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"artifact-detection","dir":"","previous_headings":"","what":"Artifact detection","title":"SpotSweeper","text":"Large artifacts can visualized detected calculating local variance standard QC metrics, mitochondrial ratio.","code":"# load in DLPFC sample with hangnail artifact data(DLPFC_artifact) spe <- DLPFC_artifact  # inspect colData before artifact detection colnames(colData(spe)) #>  [1] \"sample_id\"          \"in_tissue\"          \"array_row\"          #>  [4] \"array_col\"          \"key\"                \"sum_umi\"            #>  [7] \"sum_gene\"           \"expr_chrM\"          \"expr_chrM_ratio\"    #> [10] \"ManualAnnotation\"   \"subject\"            \"region\"             #> [13] \"sex\"                \"age\"                \"diagnosis\"          #> [16] \"sample_id_complete\" \"count\"              \"sizeFactor\"  # find artifacts using  spe <- findArtifacts(spe,                       mito_percent=\"expr_chrM_ratio\",                      mito_sum=\"expr_chrM\",                      n_rings=5,                      name=\"artifact\"                     )  # check that \"artifact\" is now in colData colnames(colData(spe)) #>  [1] \"sample_id\"            \"in_tissue\"            \"array_row\"            #>  [4] \"array_col\"            \"key\"                  \"sum_umi\"              #>  [7] \"sum_gene\"             \"expr_chrM\"            \"expr_chrM_ratio\"      #> [10] \"ManualAnnotation\"     \"subject\"              \"region\"               #> [13] \"sex\"                  \"age\"                  \"diagnosis\"            #> [16] \"sample_id_complete\"   \"count\"                \"sizeFactor\"           #> [19] \"expr_chrM_ratio_log2\" \"expr_chrM_log2\"       \"coords\"               #> [22] \"k6\"                   \"k18\"                  \"k36\"                  #> [25] \"k60\"                  \"k90\"                  \"Kmeans\"               #> [28] \"artifact\" # plotting using escheR p1 <- make_escheR(spe) |>    add_fill(var = \"expr_chrM_ratio\", point_size=1.25)  p2 <- make_escheR(spe) |>    add_fill(var = \"expr_chrM\", point_size=1.25)  p3 <- make_escheR(spe) |>    add_fill(var = \"k18\", point_size=1.25)     p4 <- make_escheR(spe) |>    add_fill(var = \"artifact\", point_size=1.25) +   scale_fill_manual(     name = \"\",     values = c(       \"TRUE\" = \"red\",       \"FALSE\" = \"grey\")   ) #> Scale for fill is already present. #> Adding another scale for fill, which will replace the existing scale.  plot_list <- list(p1, p2, p3, p4) ggarrange(   plotlist = plot_list,   ncol = 2, nrow = 2,   common.legend = FALSE )"},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"SpotSweeper","text":"Please look preprint describing SpotSweeper bioRxiv. , please cite package follows:","code":"citation(\"SpotSweeper\")"},{"path":"https://mictott.github.io/SpotSweeper/index.html","id":"development-tools","dir":"","previous_headings":"","what":"Development tools","title":"SpotSweeper","text":"","code":"* Continuous code testing is possible thanks to [GitHub actions](https://www.tidyverse.org/blog/2020/04/usethis-1-6-0/)  through `r BiocStyle::Biocpkg('biocthis')`. * The [documentation website](http://MicTott.github.io/SpotSweeper) is automatically updated thanks to `r BiocStyle::CRANpkg('pkgdown')`. * The code is styled automatically thanks to `r BiocStyle::CRANpkg('styler')`. * The documentation is formatted thanks to `r BiocStyle::CRANpkg('devtools')` and `r BiocStyle::CRANpkg('roxygen2')`.  This package was developed using `r BiocStyle::Biocpkg('biocthis')`."},{"path":"https://mictott.github.io/SpotSweeper/reference/DLPFC_artifact.html","id":null,"dir":"Reference","previous_headings":"","what":"human DLPFC dataset with a technical artifact (hangnail). — DLPFC_artifact","title":"human DLPFC dataset with a technical artifact (hangnail). — DLPFC_artifact","text":"DLPFC_artifact dataset SpatialExperiment object containing single-sample subset human dorsolateral prefrontal cortex (DLPFC) dataset Hukki-Myers et al. 2023. particular sample (\"Br2743_ant\") included demonstrate identification removal technical artifacts within spatial transcriptomics data. dataset serves example artifact detection using 'SpotSweeper' workflow.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/DLPFC_artifact.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"human DLPFC dataset with a technical artifact (hangnail). — DLPFC_artifact","text":"","code":"data(DLPFC_artifact)"},{"path":"https://mictott.github.io/SpotSweeper/reference/DLPFC_artifact.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"human DLPFC dataset with a technical artifact (hangnail). — DLPFC_artifact","text":"SpatialExperiment object.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/DLPFC_artifact.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"human DLPFC dataset with a technical artifact (hangnail). — DLPFC_artifact","text":"spatialLIBD","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/DLPFC_artifact.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"human DLPFC dataset with a technical artifact (hangnail). — DLPFC_artifact","text":"Hukki-Myers et al. (2023) bioRxiv (bioRxiv)","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/DLPFC_artifact.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"human DLPFC dataset with a technical artifact (hangnail). — DLPFC_artifact","text":"","code":"data(DLPFC_artifact)"},{"path":"https://mictott.github.io/SpotSweeper/reference/findArtifacts.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify and annotate artifacts in spatial transcriptomics data — findArtifacts","title":"Identify and annotate artifacts in spatial transcriptomics data — findArtifacts","text":"function identifies annotates potential artifacts spatial transcriptomics data. Artifacts detected based local mito variance, results added original SpatialExperiment (sce) object.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/findArtifacts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify and annotate artifacts in spatial transcriptomics data — findArtifacts","text":"","code":"findArtifacts(   spe,   mito_percent = \"expr_chrM_ratio\",   mito_sum = \"expr_chrM\",   samples = \"sample_id\",   n_rings = 5,   n_cores = 1,   log2 = TRUE,   name = \"artifact\",   var_output = TRUE )"},{"path":"https://mictott.github.io/SpotSweeper/reference/findArtifacts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify and annotate artifacts in spatial transcriptomics data — findArtifacts","text":"spe SingleCellExperiment object. mito_percent column name representing mitochondrial percent. Default \"expr_chrM_ratio\". mito_sum column name representing sum mitochondrial expression. Default \"expr_chrM\". samples column name representing sample IDs. Default \"sample_id\". n_rings number rings local mito variance calculation. Default 5. n_cores Number cores use parallel processing. Default 1. log2 Logical, indicating whether log2 transform specified features. Default TRUE. name Prefix local variance column names. Default \"artifact\". var_output Logical, indicating whether include local variances output. Default TRUE.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/findArtifacts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify and annotate artifacts in spatial transcriptomics data — findArtifacts","text":"Returns modified SingleCellExperiment object artifact annotations.","code":""},{"path":[]},{"path":"https://mictott.github.io/SpotSweeper/reference/findArtifacts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify and annotate artifacts in spatial transcriptomics data — findArtifacts","text":"","code":"library(SpotSweeper) library(SpatialExperiment) #> Loading required package: SingleCellExperiment #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: ‘MatrixGenerics’ #> The following objects are masked from ‘package:matrixStats’: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted, #>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin, #>     pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table, #>     tapply, union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: ‘S4Vectors’ #> The following object is masked from ‘package:utils’: #>  #>     findMatches #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: ‘Biobase’ #> The following object is masked from ‘package:MatrixGenerics’: #>  #>     rowMedians #> The following objects are masked from ‘package:matrixStats’: #>  #>     anyMissing, rowMedians  # load example data spe <- STexampleData::Visium_humanDLPFC() #> see ?STexampleData and browseVignettes('STexampleData') for documentation #> downloading 1 resources #> retrieving 1 resource #> loading from cache  # change from gene id to gene names rownames(spe) <- rowData(spe)$gene_name  # show column data before SpotSweepR colnames(colData(spe)) #> [1] \"barcode_id\"   \"sample_id\"    \"in_tissue\"    \"array_row\"    \"array_col\"    #> [6] \"ground_truth\" \"cell_count\"    # drop out-of-tissue spots spe <- spe[, spe$in_tissue == 1] spe <- spe[, !is.na(spe$ground_truth)]  # Identifying the mitochondrial transcripts in our SpatialExperiment. is.mito <- rownames(spe)[grepl(\"^MT-\", rownames(spe))]  # Calculating QC metrics for each spot using scuttle spe<- scuttle::addPerCellQCMetrics(spe, subsets=list(Mito=is.mito)) colnames(colData(spe)) #>  [1] \"barcode_id\"            \"sample_id\"             \"in_tissue\"             #>  [4] \"array_row\"             \"array_col\"             \"ground_truth\"          #>  [7] \"cell_count\"            \"sum\"                   \"detected\"              #> [10] \"subsets_Mito_sum\"      \"subsets_Mito_detected\" \"subsets_Mito_percent\"  #> [13] \"total\"                  # find rtifacts spe <- findArtifacts(spe,                      mito_percent=\"subsets_Mito_percent\",                      mito_sum=\"subsets_Mito_sum\",                      n_rings=5,                      name=\"artifact\"                    )"},{"path":"https://mictott.github.io/SpotSweeper/reference/localOutliers.html","id":null,"dir":"Reference","previous_headings":"","what":"localOutliers Function — localOutliers","title":"localOutliers Function — localOutliers","text":"function detects local outliers based k-nearest neighbors based either univariate (z-score thresholds per QC metrics) multivariate approach (Local Outlier Factor).","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/localOutliers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"localOutliers Function — localOutliers","text":"","code":"localOutliers(   spe,   n_neighbors = 36,   features = c(\"sum_umi\", \"sum_gene\", \"expr_chrM_ratio\"),   method = \"multivariate\",   samples = \"sample_id\",   log2 = TRUE,   cutoff = 2.58,   scale = TRUE,   minPts = 20,   data_output = FALSE,   n_cores = 1 )"},{"path":"https://mictott.github.io/SpotSweeper/reference/localOutliers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"localOutliers Function — localOutliers","text":"spe SpatialExperiment object following columns colData: sample_id, sum_umi, sum_gene n_neighbors Number nearest neighbors use outlier detection features Vector features use outlier detection method Method use outlier detection (univariate multivariate) samples Column name colData use sample IDs log2 Logical indicating whether log2 transform features cutoff Cutoff outlier detection scale Logical indicating whether scale features LOF calculation (recommended) minPts Minimum number points (nearest neighbors) use LOF calculation data_output Logical indicating whether output z-scores feature n_cores Number cores use parallelization findKNN function","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/localOutliers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"localOutliers Function — localOutliers","text":"SpatialExperiment object updated colData","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/localOutliers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"localOutliers Function — localOutliers","text":"","code":"library(SpotSweeper) library(SpatialExperiment)  # load example data spe <- STexampleData::Visium_humanDLPFC() #> see ?STexampleData and browseVignettes('STexampleData') for documentation #> loading from cache  # change from gene id to gene names rownames(spe) <- rowData(spe)$gene_name  # show column data before SpotSweepR colnames(colData(spe)) #> [1] \"barcode_id\"   \"sample_id\"    \"in_tissue\"    \"array_row\"    \"array_col\"    #> [6] \"ground_truth\" \"cell_count\"    # drop out-of-tissue spots spe <- spe[, spe$in_tissue == 1] spe <- spe[, !is.na(spe$ground_truth)]  # Identifying the mitochondrial transcripts in our SpatialExperiment. is.mito <- rownames(spe)[grepl(\"^MT-\", rownames(spe))]  # Calculating QC metrics for each spot using scuttle spe<- scuttle::addPerCellQCMetrics(spe, subsets=list(Mito=is.mito)) colnames(colData(spe)) #>  [1] \"barcode_id\"            \"sample_id\"             \"in_tissue\"             #>  [4] \"array_row\"             \"array_col\"             \"ground_truth\"          #>  [7] \"cell_count\"            \"sum\"                   \"detected\"              #> [10] \"subsets_Mito_sum\"      \"subsets_Mito_detected\" \"subsets_Mito_percent\"  #> [13] \"total\"                   features <- c('sum' ,'detected', \"subsets_Mito_percent\") spe<- localOutliers(spe,                     features=features,                     n_neighbors=36,                     data_output=TRUE,                     method=\"multivariate\"                     )"},{"path":"https://mictott.github.io/SpotSweeper/reference/localVariance.html","id":null,"dir":"Reference","previous_headings":"","what":"localVariance Function — localVariance","title":"localVariance Function — localVariance","text":"function calculates local variance based kNN.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/localVariance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"localVariance Function — localVariance","text":"","code":"localVariance(   spe,   n_neighbors = 36,   features = c(\"expr_chrM_ratio\"),   samples = \"sample_id\",   log2 = FALSE,   n_cores = 1,   name = NULL )"},{"path":"https://mictott.github.io/SpotSweeper/reference/localVariance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"localVariance Function — localVariance","text":"spe SpatialExperiment object following columns colData: sample_id, sum_umi, sum_gene n_neighbors Number nearest neighbors use variance calculation features Features use variance calculation samples Column colData use sample ID log2 Whether log2 transform features n_cores Number cores use parallelization name Name new column add colData","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/localVariance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"localVariance Function — localVariance","text":"SpatialExperiment object feature variance added colData","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/localVariance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"localVariance Function — localVariance","text":"","code":"library(SpotSweeper) library(SpatialExperiment)  # load example data spe <- STexampleData::Visium_humanDLPFC() #> see ?STexampleData and browseVignettes('STexampleData') for documentation #> loading from cache  # change from gene id to gene names rownames(spe) <- rowData(spe)$gene_name  # show column data before SpotSweepR colnames(colData(spe)) #> [1] \"barcode_id\"   \"sample_id\"    \"in_tissue\"    \"array_row\"    \"array_col\"    #> [6] \"ground_truth\" \"cell_count\"    # drop out-of-tissue spots spe <- spe[, spe$in_tissue == 1] spe <- spe[, !is.na(spe$ground_truth)]  # Identifying the mitochondrial transcripts in our SpatialExperiment. is.mito <- rownames(spe)[grepl(\"^MT-\", rownames(spe))]  # Calculating QC metrics for each spot using scuttle spe<- scuttle::addPerCellQCMetrics(spe, subsets=list(Mito=is.mito)) colnames(colData(spe)) #>  [1] \"barcode_id\"            \"sample_id\"             \"in_tissue\"             #>  [4] \"array_row\"             \"array_col\"             \"ground_truth\"          #>  [7] \"cell_count\"            \"sum\"                   \"detected\"              #> [10] \"subsets_Mito_sum\"      \"subsets_Mito_detected\" \"subsets_Mito_percent\"  #> [13] \"total\"                  spe <- localVariance(spe,                      features = \"subsets_Mito_percent\",                      n_neighbors=36,                      name=\"local_mito_variance_k36\"                      )"},{"path":"https://mictott.github.io/SpotSweeper/reference/modified_z.html","id":null,"dir":"Reference","previous_headings":"","what":"Modified Z-score Function — modified_z","title":"Modified Z-score Function — modified_z","text":"function calculates returns standardized (z-score like) values based Median Absolute Deviation (MAD) method. robust method detect outliers data might normally distributed. function replication spatialEco::outliers() package longer available CRAN October 2023.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/modified_z.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modified Z-score Function — modified_z","text":"","code":"modified_z(x, s = 1.4826)"},{"path":"https://mictott.github.io/SpotSweeper/reference/modified_z.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modified Z-score Function — modified_z","text":"x numeric vector outliers need detected. s constant used MAD calculation, default 1.4826.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/modified_z.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Modified Z-score Function — modified_z","text":"numeric vector standardized values. Outliers typically values far zero.","code":""},{"path":"https://mictott.github.io/SpotSweeper/reference/modified_z.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Modified Z-score Function — modified_z","text":"","code":"data <- c(1, 2, 3, 4, 5, 100) modified_z(data) #> [1] -0.758240 -0.454944 -0.151648  0.151648  0.454944 29.268065"},{"path":"https://mictott.github.io/SpotSweeper/news/index.html","id":"spotsweeper-0990","dir":"Changelog","previous_headings":"","what":"SpotSweeper 0.99.0","title":"SpotSweeper 0.99.0","text":"NEW FEATURES Added NEWS.md file track changes package. SIGNIFICANT USER-VISIBLE CHANGES main changes function foo() parameter param. BUG FIXES bug fixes. See details http://bioconductor.org/developers/package-guidelines/#news.","code":""}]
